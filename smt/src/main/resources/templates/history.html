<!DOCTYPE html >
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <title>历史记录</title>
    <meta http-equiv="content-type" content="text/html; charset=utf-8"/>
    <link href="/css/history.css" type="text/css" rel="stylesheet">
    <link href="/css/index.css" type="text/css" rel="stylesheet">
    <script src="/js/vue@2.6.10.js"></script>
    <script src="/js/axios@0.18.0.min.js"></script>
    <script src="/js/index.js"></script>
    <script src="/js/jquery.min.js"></script>
    <script src="http://mockjs.com/dist/mock.js"></script>
</head>
<body>
<div th:replace="include::sidebar"></div>
<div id="app">
    <div id="u3" class="module_name">
        <p><span>历史记录</span></p>
    </div>
    <div id="u4" class="level_info">
        <p><span>当前等级</span><br><span>SMT Lev.{{ level }}</span></p>
    </div>
    <div id="u5" class="">
        <p><span>课课练</span></p>
    </div>
    <div id="u6" class="table">
        <template>
            <el-table :data="tableData1" height="300" stripe border style="width: 100%">
              <el-table-column prop="name" label="练习" width="100"></el-table-column>
              <el-table-column prop="date" label="时间" width="180"></el-table-column>
              <el-table-column prop="score" label="分数"></el-table-column>
              <el-table-column fixed="right" label="操作" width="100">
                  <template slot-scope="scope">
                      <el-button @click="Click(scope.row)" type="text" size="small">详情</el-button>
                  </template>
              </el-table-column>
            </el-table>
        </template>
    </div>
    <div id="u7" class="">
        <p><span>AI练习</span></p>
    </div>
    <div id="u8" class="table">
        <template>
            <el-table :data="tableData2" height="300" stripe border style="width: 100%">
              <el-table-column prop="name" label="练习" width="100"></el-table-column>
              <el-table-column prop="date" label="时间" width="180"></el-table-column>
              <el-table-column prop="score" label="分数"></el-table-column>
              <el-table-column fixed="right" label="操作" width="100">
                <template slot-scope="scope">
                    <el-button @click="Click(scope.row)" type="text" size="small">详情</el-button>
                </template>
            </el-table-column>
            </el-table>
        </template>
    </div>
</div>
</body>
<script>
    Mock.mock('/getTable_lesson',{
        "tableList|8": [{
            "name":"lesson",
            "date":"@datetime",
            "score|60-100":100,
        }]
    })

    Mock.mock('/getTable_ai',{
        "tableList|10": [{
            "name|1":["test","practise"],
            "date":"@datetime",
            "score|60-100":100,
        }]
    })

    Mock.mock('/historyInitial',{
        "level|1-6":1,
    })

    var app = new Vue({
        el: "#app",
        data: {
            tableData1: [],
            tableData2: [],
            level: 0
        },

        methods: {
            Click: function (row) {
                if(row.name == 'lesson') {
                    window.location.href = '/lesson_detail_opt';
                }else if(row.name == 'test') {
                    window.location.href = '/test_detail_opt';
                }else {
                    window.location.href = '/practise_detail_opt';
                }
            },

            getSheet1: function () {
                return new Promise(resolve => {
                    axios.get('/getTable_lesson').then((response) => {
                        resolve(response.data);
                    });
                })
            },

            getSheet2: function () {
                return new Promise(resolve => {
                    axios.get('/getTable_ai').then((response) => {
                        resolve(response.data);
                    });
                })
            },

            initial: function () {
                return new Promise(resolve => {
                    axios.get('/historyInitial').then((response) => {
                        resolve(response.data);
                    });
                })
            },

            setSheet: async function () {
                var res1 = await this.getSheet1();
                var res2 = await this.getSheet2();
                var res3 = await this.initial();
                this.tableData1 = res1.tableList;
                this.tableData2 = res2.tableList;
                this.level = res3.level;
            }
        },

        created: function () {
            ;
        },

        mounted: function () {
            this.$nextTick(() => {
                this.setSheet();
            });
        }
    })
</script>
</html>